{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}

<style>
    /* Layout wrapper */
    .admin-shell {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    /* ‚ú® Hero banner with soft animation */
    .admin-hero {
        display: flex;
        justify-content: space-between;
        gap: 16px;
        padding: 18px 20px;
        border-radius: 20px;
        background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), transparent 55%),
                    radial-gradient(circle at bottom right, rgba(168, 85, 247, 0.3), transparent 60%),
                    rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.5);
        box-shadow: 0 20px 45px rgba(15, 23, 42, 0.9);
        position: relative;
        overflow: hidden;
        animation: heroFadeIn 0.8s ease-out forwards;
    }

    @keyframes heroFadeIn {
        from {opacity: 0; transform: translateY(8px);}
        to   {opacity: 1; transform: translateY(0);}
    }

    .admin-hero-main {
        z-index: 1;
    }

    .admin-hero-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 6px;
    }

    .admin-hero-sub {
        font-size: 0.9rem;
        color: var(--text-muted);
    }

    .admin-hero-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        margin-top: 10px;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(15, 118, 110, 0.3);
        font-size: 0.75rem;
        color: #6ee7b7;
        border: 1px solid rgba(45, 212, 191, 0.6);
    }

    .admin-hero-orb {
        position: absolute;
        right: -40px;
        top: -40px;
        width: 160px;
        height: 160px;
        border-radius: 999px;
        background: conic-gradient(from 180deg, #38bdf8, #a855f7, #4ade80, #38bdf8);
        opacity: 0.15;
        filter: blur(3px);
    }

    /* ‚úÖ Animated stat cards */
    .admin-stat-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 16px;
        margin-top: 2px;
    }

    .admin-stat-card {
        background: var(--bg-card);
        border-radius: 18px;
        padding: 14px 16px;
        border: 1px solid rgba(148, 163, 184, 0.5);
        display: flex;
        flex-direction: column;
        gap: 4px;
        position: relative;
        overflow: hidden;
        cursor: default;
        transform: translateY(6px);
        opacity: 0;
        animation: cardRise 0.7s ease-out forwards;
    }

    .admin-stat-card:nth-child(1) { animation-delay: 0.08s; }
    .admin-stat-card:nth-child(2) { animation-delay: 0.16s; }
    .admin-stat-card:nth-child(3) { animation-delay: 0.24s; }

    @keyframes cardRise {
        to { transform: translateY(0); opacity: 1; }
    }

    .admin-stat-icon {
        width: 28px;
        height: 28px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--accent-soft);
        font-size: 1.1rem;
        margin-bottom: 4px;
    }

    .admin-stat-label {
        font-size: 0.85rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
    }

    .admin-stat-value {
        font-size: 1.25rem;
        font-weight: 700;
    }

    .admin-stat-note {
        font-size: 0.8rem;
        color: var(--text-muted);
    }

    /* Mini "sparkline" charts */
    .sparkline {
        display: flex;
        gap: 4px;
        align-items: flex-end;
        margin-top: 6px;
    }
    .sparkline-bar {
        width: 6px;
        border-radius: 999px;
        background: linear-gradient(to top, rgba(56, 189, 248, 0.1), #38bdf8);
        transform-origin: bottom;
        transform: scaleY(var(--v));
        opacity: 0.9;
    }
    .sparkline-bar:nth-child(2) { background: linear-gradient(to top, rgba(168,85,247,0.1), #a855f7); }
    .sparkline-bar:nth-child(3) { background: linear-gradient(to top, rgba(34,197,94,0.1), #4ade80); }

    /* Quick links row */
    .admin-quick-links {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
    }

    .admin-quick-btn {
        border-radius: 999px;
        padding: 6px 12px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        background: rgba(15, 23, 42, 0.9);
        color: var(--text-light);
        font-size: 0.8rem;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: background 0.18s ease, transform 0.18s ease, box-shadow 0.18s ease;
    }

    .admin-quick-btn:hover {
        background: linear-gradient(135deg, #38bdf8, #a855f7);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.9);
        transform: translateY(-1px);
    }

    .admin-main-grid {
        display: grid;
        grid-template-columns: minmax(0, 2.1fr) minmax(260px, 1.1fr);
        gap: 18px;
        margin-top: 6px;
    }

    .admin-card {
        background: var(--bg-card-soft);
        border-radius: 20px;
        padding: 14px 16px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        box-shadow: 0 14px 28px rgba(15, 23, 42, 0.85);
    }

    .admin-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 6px;
    }

    .admin-card-title {
        font-size: 0.95rem;
        font-weight: 600;
    }

    .admin-card-sub {
        font-size: 0.78rem;
        color: var(--text-muted);
    }

    .admin-app-list {
        margin-top: 6px;
    }

    .admin-app-block {
        margin-top: 10px;
        padding: 10px 10px 6px;
        border-radius: 14px;
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .admin-app-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 6px;
    }

    .admin-app-icon {
        width: 26px;
        height: 26px;
        border-radius: 9px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        background: rgba(56, 189, 248, 0.1);
    }

    .admin-app-name {
        font-size: 0.9rem;
        font-weight: 600;
    }

    .admin-model-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 2px;
        border-radius: 9px;
        font-size: 0.86rem;
        transition: background 0.15s ease, transform 0.15s ease;
    }

    .admin-model-row:hover {
        background: rgba(15, 118, 110, 0.3);
        transform: translateY(-1px);
    }

    .admin-model-links a {
        font-size: 0.78rem;
        text-decoration: none;
        margin-left: 8px;
    }

    .admin-chip {
        font-size: 0.72rem;
        padding: 2px 6px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        color: var(--text-muted);
    }

    .admin-side-note {
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-top: 4px;
    }
</style>

<div class="admin-shell">

    <!-- HERO + STAT CARDS -->
    <section class="admin-hero">
        <div class="admin-hero-main">
            <div class="admin-hero-title">
                Welcome back, {{ request.user.username|default:"Admin" }} üëã
            </div>
            <div class="admin-hero-sub">
                Monitor datasets, model versions and churn predictions from one sleek console.
            </div>
            <div class="admin-hero-badge">
                <span>‚ö° Realtime-friendly layout</span>
                <span>‚Ä¢</span>
                <span>Optimized for your churn app</span>
            </div>

            <div class="admin-stat-row" style="margin-top: 12px;">
                <!-- These three cards are static labels; you can later wire counts if you want -->
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">üìÇ</div>
                    <div class="admin-stat-label">Datasets</div>
                    <div class="admin-stat-value">Datasets</div>
                    <div class="admin-stat-note">Manage source CSVs used for training models.</div>
                    <div class="sparkline">
                        <span class="sparkline-bar" style="--v:0.6"></span>
                        <span class="sparkline-bar" style="--v:0.9"></span>
                        <span class="sparkline-bar" style="--v:0.7"></span>
                    </div>
                </div>

                <div class="admin-stat-card">
                    <div class="admin-stat-icon">üß†</div>
                    <div class="admin-stat-label">Models</div>
                    <div class="admin-stat-value">Model Versions</div>
                    <div class="admin-stat-note">Inspect metrics, confusion matrix and details.</div>
                    <div class="sparkline">
                        <span class="sparkline-bar" style="--v:0.5"></span>
                        <span class="sparkline-bar" style="--v:0.8"></span>
                        <span class="sparkline-bar" style="--v:1.0"></span>
                    </div>
                </div>

                <div class="admin-stat-card">
                    <div class="admin-stat-icon">üìä</div>
                    <div class="admin-stat-label">Predictions</div>
                    <div class="admin-stat-value">Churn Events</div>
                    <div class="admin-stat-note">Track single & batch predictions over time.</div>
                    <div class="sparkline">
                        <span class="sparkline-bar" style="--v:0.7"></span>
                        <span class="sparkline-bar" style="--v:0.4"></span>
                        <span class="sparkline-bar" style="--v:0.9"></span>
                    </div>
                </div>
            </div>

            <!-- Quick links to your app views -->
            <div class="admin-quick-links">
                <a class="admin-quick-btn" href="{% url 'analytics:dashboard' %}">
                    üìä Analytics Dashboard
                </a>
                <a class="admin-quick-btn" href="{% url 'analytics:upload_dataset' %}">
                    ‚¨Ü Upload Dataset
                </a>
                <a class="admin-quick-btn" href="{% url 'analytics:model_list' %}">
                    üß† ML Models
                </a>
            </div>
        </div>

        <div class="admin-hero-orb"></div>
    </section>

    <!-- MAIN GRID: APP LIST + SIDE CARD -->
    <section class="admin-main-grid">

        <!-- Left: apps & models -->
        <div class="admin-card">
            <div class="admin-card-header">
                <div>
                    <div class="admin-card-title">Registered Applications</div>
                    <div class="admin-card-sub">
                        All Django apps currently exposed in the admin interface.
                    </div>
                </div>
                <span class="admin-chip">Auto-discovered</span>
            </div>

            <div class="admin-app-list">
                {% if app_list %}
                    {% for app in app_list %}
                        <div class="admin-app-block">
                            <div class="admin-app-header">
                                <div class="admin-app-icon">
                                    {% if app.name|lower == "analytics" %}
                                        üìà
                                    {% elif app.name|lower == "authentication and authorization" %}
                                        üîê
                                    {% else %}
                                        üß©
                                    {% endif %}
                                </div>
                                <div class="admin-app-name">{{ app.name }}</div>
                            </div>

                            {% for model in app.models %}
                                <div class="admin-model-row">
                                    <div>{{ model.name }}</div>
                                    <div class="admin-model-links">
                                        {% if model.admin_url %}
                                            <a href="{{ model.admin_url }}">View</a>
                                        {% endif %}
                                        {% if model.add_url %}
                                            <a href="{{ model.add_url }}">+ Add</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                {% else %}
                    <p>No applications are registered yet.</p>
                {% endif %}
            </div>
        </div>

       

    </section>
</div>

{% endblock %}
